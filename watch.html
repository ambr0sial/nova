<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Watch - Nova</title>
    <meta name="description" content="Click, watch, enjoy. Nova breaks down the paywall, ensuring that quality content is accessible to everyone.">
    <meta name="keywords" content="movies, tv shows, streaming, free movies, watch online, nova streaming">
    <meta name="robots" content="index, follow">
    <meta name="author" content="ambrosial">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://novastream.top">
    <meta property="og:title" content="Nova">
    <meta property="og:description" content="Click, watch, enjoy. Nova breaks down the paywall, ensuring that quality content is accessible to everyone.">
    <meta property="og:image:width" content="300">
    <meta property="og:image:height" content="300">
    <meta property="og:image" content="https://raw.githubusercontent.com/ambr0sial/nova/main/logo.png">
    <meta property="twitter:card" content="summary">
    <meta property="twitter:url" content="https://novastream.top">
    <meta property="twitter:title" content="Nova - Watch Movies & TV Shows">
    <meta property="twitter:description" content="Click, watch, enjoy. Nova breaks down the paywall, ensuring that quality content is accessible to everyone.">
    <meta property="twitter:image" content="https://raw.githubusercontent.com/ambr0sial/nova/main/logo.png">
    <link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/ambr0sial/nova/main/logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.10.3/cdn.min.js" defer></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="sources.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <style>
        .glass-effect {
            background: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        .backdrop-gradient {
            background: linear-gradient(to bottom, rgba(17, 24, 39, 0) 0%, rgba(17, 24, 39, 1) 100%);
        }

        .nav-link {
            position: relative;
            transition: all 0.3s ease;
            padding: 0.5rem 0;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 50%;
            background: linear-gradient(to right, #a78bfa, #4c1d95);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .nav-link:hover {
            color: #a78bfa;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .section-header {
            cursor: pointer;
            user-select: none;
        }

        .section-content {
            transition: all 0.3s ease;
            overflow: hidden;
        }

        .section-content.collapsed {
            max-height: 0;
            opacity: 0;
            padding-top: 0;
            padding-bottom: 0;
        }

        .section-content.expanded {
            max-height: 2000px;
            opacity: 1;
        }

        .card-hover {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .card-hover:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 20px 30px -10px rgba(0, 0, 0, 0.5);
        }

        .card-hover:hover .card-overlay {
            opacity: 1;
        }

        .card-overlay {
            opacity: 0;
            transition: opacity 0.3s ease;
            background: linear-gradient(
                to top,
                rgba(0, 0, 0, 0.9) 0%,
                rgba(0, 0, 0, 0.7) 50%,
                rgba(0, 0, 0, 0.3) 100%
            );
        }

        @keyframes textColorAnimation {
            0% { color: #A855F7; }
            50% { color: #7C3AED; }
            100% { color: #A855F7; }
        }
        .animated-text {
            animation: textColorAnimation 2s ease-in-out infinite;
        }

        .card-hover:hover img {
            filter: blur(3px);
            transition: filter 0.3s ease;
        }

        .card-hover img {
            transition: filter 0.3s ease;
        }

        .search-container::before {
            background: radial-gradient(
                circle at var(--mouse-x, center) var(--mouse-y, center),
                rgba(168, 85, 247, 0.5) 0%,
                rgba(168, 85, 247, 0.2) 25%,
                transparent 70%
            );
        }

        .search-input:focus {
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.3);
            transform: scale(1.02);
            background: rgba(31, 41, 55, 0.9);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen" x-data="app()">
    <div id="particles-js" class="fixed inset-0 pointer-events-none z-0"></div>

    <!-- navigation -->
    <nav class="fixed w-full z-50 glass-effect">
        <div class="container mx-auto px-4 md:px-6 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-8">
                    <a href="/" class="flex items-center space-x-3">
                        <img src="logo.png" alt="Nova Logo" class="h-8 w-8 md:h-10 md:w-10">
                        <span class="text-2xl md:text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-purple-400 to-violet-800">Nova</span>
                    </a>
                    <div class="hidden md:flex space-x-6">
                        <a href="/" class="nav-link flex items-center">
                            <span>Browse</span>
                        </a>
                        <button @click="showWatchLater = true" class="nav-link flex items-center space-x-2">
                            <span>Watch Later</span>
                            <span x-show="watchLaterCount > 0" 
                                  class="bg-purple-600 text-white text-xs flex items-center justify-center rounded-full w-6 h-6" 
                                  x-text="watchLaterCount"></span>
                        </button>
                        <a href="https://github.com/ambr0sial/nova" target="_blank" class="nav-link flex items-center">
                            <span>GitHub</span>
                        </a>
                        <a href="https://ko-fi.com/ambrosial" target="_blank" class="nav-link flex items-center">
                            <span>Ko-Fi</span>
                        </a>
                        <a href="https://discord.gg/s9kUZw7CqP" target="_blank" class="nav-link flex items-center">
                            <span>Discord</span>
                        </a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="settings.html" class="text-gray-400 hover:text-purple-400 transition-colors duration-300" title="Settings">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </a>
                    <!-- mobile menu button -->
                    <button @click="mobileMenu = !mobileMenu" class="md:hidden text-gray-300 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- mobile menu -->
            <div x-show="mobileMenu" 
                x-transition:enter="transition ease-out duration-200"
                x-transition:enter-start="opacity-0 transform -translate-y-2"
                x-transition:enter-end="opacity-100 transform translate-y-0"
                x-transition:leave="transition ease-in duration-150"
                x-transition:leave-start="opacity-100 transform translate-y-0"
                x-transition:leave-end="opacity-0 transform -translate-y-2"
                class="md:hidden mt-4 pb-4">
                <div class="flex flex-col space-y-4">
                    <a href="/" class="px-4 py-2 hover:bg-gray-800 rounded-lg transition-colors">Browse</a>
                    <button @click="showWatchLater = true; mobileMenu = false" 
                            class="flex items-center justify-between px-4 py-2 hover:bg-gray-800 rounded-lg transition-colors">
                        <span>Watch Later</span>
                        <span x-show="watchLaterCount > 0" 
                              class="bg-purple-600 text-white text-xs flex items-center justify-center rounded-full w-6 h-6" 
                              x-text="watchLaterCount"></span>
                    </button>
                    <a href="https://github.com/ambr0sial/nova" target="_blank" 
                       class="px-4 py-2 hover:bg-gray-800 rounded-lg transition-colors">GitHub</a>
                    <a href="https://ko-fi.com/ambrosial" target="_blank" 
                       class="px-4 py-2 hover:bg-gray-800 rounded-lg transition-colors">Ko-Fi</a>
                    <a href="https://discord.gg/s9kUZw7CqP" target="_blank" 
                       class="px-4 py-2 hover:bg-gray-800 rounded-lg transition-colors">Discord</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- content -->
    <div class="pt-16">
        <!-- backdrop -->
        <div class="relative h-[30vh] sm:h-[40vh] md:h-[60vh]" x-show="content">
            <div class="absolute inset-0 bg-cover bg-center" :style="'background-image: url(https://image.tmdb.org/t/p/original' + content?.backdrop_path + ')'"></div>
            <div class="absolute inset-0 bg-gradient-to-t from-gray-900 via-gray-900/80 to-transparent"></div>
            <div class="absolute bottom-0 left-0 right-0 p-4 md:p-6 lg:p-12">
                <div class="flex flex-wrap gap-2 mb-3 md:mb-4">
                    <template x-for="genre in content?.genres" :key="genre.id">
                        <span class="px-2 md:px-3 py-1 text-xs md:text-sm bg-black/30 backdrop-blur-sm rounded-full text-gray-300" x-text="genre.name"></span>
                    </template>
                </div>
                
                <h1 class="text-2xl sm:text-3xl md:text-4xl lg:text-6xl font-bold tracking-wide" x-text="content?.title || content?.name"></h1>
                
                <div class="mt-3 md:mt-4 flex items-center flex-wrap gap-2 md:gap-4 text-xs md:text-sm lg:text-base text-gray-300">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-yellow-400 mr-1" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                        <span x-text="content?.vote_average?.toFixed(1)"></span>
                        <span class="text-gray-400 ml-1" x-text="'(' + content?.vote_count + ')'"></span>
                    </div>
                    <div class="w-1 h-1 bg-gray-500 rounded-full"></div>
                    <span x-text="content?.release_date?.substring(0, 4) || content?.first_air_date?.substring(0, 4)"></span>
                    <div class="w-1 h-1 bg-gray-500 rounded-full"></div>
                    <span x-text="Math.floor((content?.runtime || content?.episode_run_time?.[0] || 0) / 60) + 'h ' + ((content?.runtime || content?.episode_run_time?.[0] || 0) % 60) + 'm'"></span>
                </div>
            </div>
        </div>

        <!-- main content -->
        <div class="container mx-auto px-4 md:px-6 py-6 md:py-8 relative z-10">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- left column (video player and controls) -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- video player -->
                    <div class="bg-gray-800 rounded-lg overflow-hidden">
                        <div class="relative pt-[56.25%]">
                            <iframe x-bind:src="currentVideoUrl" 
                                    class="absolute top-0 left-0 w-full h-full" 
                                    frameborder="0" 
                                    scrolling="no" 
                                    @error="checkProviderStatus()"
                                    @load="handleProviderLoad()"
                                    allowfullscreen>
                            </iframe>
                            <button @click="toggleWatchLater(content)" 
                                    class="absolute top-2 right-2 p-1.5 md:p-2 bg-gray-900 bg-opacity-75 rounded-full hover:bg-purple-600 transition-colors duration-300"
                                    :class="isInWatchLater(content) ? 'text-purple-400' : 'text-white'">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-6 md:w-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/>
                                </svg>
                            </button>
                            <!-- provider down message -->
                            <div x-show="showDownMessage" 
                                 class="absolute inset-0 flex items-center justify-center bg-gray-900 bg-opacity-90">
                                <div class="text-center px-4">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 md:h-12 md:w-12 mx-auto text-red-500 mb-3 md:mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                    </svg>
                                    <p class="text-lg md:text-xl font-semibold text-white mb-2">Source unavailable, trying alternatives... üîÑ</p>
                                    <p class="text-sm md:text-base text-gray-400">If this persists, you can manually select another source below!</p>
                                </div>
                            </div>
                        </div>
                        <div class="p-3 md:p-4">
                            <div class="flex items-center justify-between text-xs md:text-sm text-gray-400">
                                <div class="hidden lg:block">
                                    <a href="https://ko-fi.com/ambrosial" target="_blank" class="text-purple-400 hover:text-purple-300 transition-colors">Support me here</a>
                                </div>
                                <div class="text-center mx-auto animated-text" x-show="content?.runtime || content?.episode_run_time">
                                    <span>If you start now, it'll end at </span>
                                    <span x-text="(() => {
                                        const runtime = content?.runtime || content?.episode_run_time?.[0] || 0;
                                        const now = new Date();
                                        const endTime = new Date(now.getTime() + runtime * 60000);
                                        return endTime.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                                    })()"></span>
                                </div>
                                <div class="hidden lg:block">
                                    <a href="https://ko-fi.com/ambrosial" target="_blank" class="text-purple-400 hover:text-purple-300 transition-colors">Support me here</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- episode selector -->
                    <template x-if="isShow">
                        <div class="bg-gray-800 rounded-lg p-4 md:p-6 space-y-4">
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-3">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4v16M17 4v16M3 8h4m10 0h4M3 12h18M3 16h4m10 0h4M4 20h16a1 1 0 001-1V5a1 1 0 00-1-1H4a1 1 0 00-1 1v14a1 1 0 001 1z" />
                                    </svg>
                                    <h3 class="text-lg md:text-xl font-semibold">Episodes</h3>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button @click="viewMode = viewMode === 'grid' ? 'list' : 'grid'" 
                                            class="p-2 hover:bg-gray-700 rounded-lg transition-colors">
                                        <template x-if="viewMode === 'grid'">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 hover:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                                            </svg>
                                        </template>
                                        <template x-if="viewMode === 'list'">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-400 hover:text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z" />
                                            </svg>
                                        </template>
                                    </button>
                                </div>
                            </div>

                            <!-- season selector -->
                            <div class="relative">
                                <div class="flex items-center space-x-2 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-gray-800">
                                    <template x-for="season in seasons" :key="season">
                                        <button @click="selectedSeason = season; updateEpisodes()"
                                                class="px-4 py-2 rounded-lg transition-all duration-300 whitespace-nowrap"
                                                :class="selectedSeason === season ? 'bg-purple-600 text-white' : 'bg-gray-700 hover:bg-gray-600 text-gray-300'">
                                            <span x-text="'Season ' + season"></span>
                                        </button>
                                    </template>
                                </div>
                            </div>

                            <!-- episodes grid/list view -->
                            <div :class="viewMode === 'grid' ? 'grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4' : 'space-y-4'">
                                <template x-for="episode in seasonData?.episodes" :key="episode.episode_number">
                                    <div @click="selectedEpisode = episode.episode_number; loadEpisode()"
                                         :class="[
                                             viewMode === 'grid' 
                                                ? 'bg-gray-700 rounded-lg overflow-hidden cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-lg'
                                                : 'bg-gray-700 rounded-lg overflow-hidden cursor-pointer hover:bg-gray-600 transition-colors',
                                             selectedEpisode === episode.episode_number 
                                                ? 'ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-900'
                                                : ''
                                         ]">
                                        <template x-if="viewMode === 'grid'">
                                            <div>
                                                <div class="relative aspect-video">
                                                    <img :src="episode.still_path 
                                                              ? 'https://image.tmdb.org/t/p/w300' + episode.still_path
                                                              : 'https://via.placeholder.com/300x169'"
                                                         :alt="episode.name"
                                                         class="w-full h-full object-cover">
                                                    <div class="absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/80 to-transparent">
                                                        <span class="text-sm font-medium" x-text="'Episode ' + episode.episode_number"></span>
                                                    </div>
                                                </div>
                                                <div class="p-3">
                                                    <h4 class="font-medium text-sm line-clamp-1" x-text="episode.name"></h4>
                                                    <p class="text-xs text-gray-400 mt-1 line-clamp-2" x-text="episode.overview || 'No description available.'"></p>
                                                </div>
                                            </div>
                                        </template>
                                        <template x-if="viewMode === 'list'">
                                            <div class="flex items-start p-3 space-x-3">
                                                <div class="relative w-32 flex-shrink-0">
                                                    <img :src="episode.still_path 
                                                              ? 'https://image.tmdb.org/t/p/w300' + episode.still_path
                                                              : 'https://via.placeholder.com/300x169'"
                                                         :alt="episode.name"
                                                         class="w-full aspect-video object-cover rounded">
                                                </div>
                                                <div class="flex-1 min-w-0">
                                                    <div class="flex items-center justify-between">
                                                        <span class="text-sm font-medium text-gray-400" x-text="'Episode ' + episode.episode_number"></span>
                                                        <span class="text-xs text-gray-500" x-text="episode.air_date"></span>
                                                    </div>
                                                    <h4 class="font-medium mt-1" x-text="episode.name"></h4>
                                                    <p class="text-sm text-gray-400 mt-1 line-clamp-2" x-text="episode.overview || 'No description available.'"></p>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>

                    <!-- source selector -->
                    <div class="bg-gray-800 rounded-lg p-4 md:p-6">
                        <div class="flex items-center space-x-3 mb-3 md:mb-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 md:h-6 md:w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            <h3 class="text-lg md:text-xl font-semibold">Stream</h3>
                        </div>
                        <div class="space-y-3 md:space-y-4">
                            <div class="space-y-2">
                                <h4 class="text-sm md:text-base text-gray-300 font-medium">English Sources:</h4>
                                <div class="flex flex-wrap gap-2">
                                    <template x-for="source in availableSources" :key="source.id">
                                        <template x-if="!source.isFrench">
                                            <button 
                                                @click="selectedSource = source.id; updateVideoUrl()"
                                                class="px-3 md:px-4 py-1.5 md:py-2 rounded-lg transition-all duration-300 text-sm md:text-base"
                                                :class="selectedSource === source.id ? 'bg-purple-600 text-white' : 'bg-gray-700 hover:bg-gray-600 text-gray-200'"
                                                x-text="source.name">
                                            </button>
                                        </template>
                                    </template>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <h4 class="text-sm md:text-base text-gray-300 font-medium">French Sources:</h4>
                                <div class="flex flex-wrap gap-2">
                                    <template x-for="source in availableSources" :key="source.id">
                                        <template x-if="source.isFrench">
                                            <button 
                                                @click="selectedSource = source.id; updateVideoUrl()"
                                                class="px-3 md:px-4 py-1.5 md:py-2 rounded-lg transition-all duration-300 text-sm md:text-base"
                                                :class="selectedSource === source.id ? 'bg-purple-600 text-white' : 'bg-gray-700 hover:bg-gray-600 text-gray-200'"
                                                x-text="source.name">
                                            </button>
                                        </template>
                                    </template>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- torrent download section -->
                    <div class="mt-8 bg-gray-800 rounded-lg p-6">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                <h3 class="text-xl font-semibold text-gray-200">Download</h3>
                            </div>
                            <template x-if="isShow">
                                <div class="flex items-center space-x-2">
                                    <label class="text-gray-400">Season:</label>
                                    <select x-model="selectedTorrentSeason" @change="fetchTorrentInfo()" class="bg-gray-700 text-gray-200 rounded px-2 py-1">
                                        <template x-for="season in seasons" :key="season">
                                            <option :value="season" x-text="season"></option>
                                        </template>
                                    </select>
                                </div>
                            </template>
                        </div>

                        <div x-show="torrentInfo === undefined" class="text-center text-gray-400 py-4">
                            Loading torrent information...
                        </div>

                        <div x-show="torrentInfo === null" class="text-center text-gray-400 py-4">
                            No torrents found
                        </div>

                        <div x-show="torrentInfo && torrentInfo.length > 0" class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            <template x-for="torrent in torrentInfo" :key="torrent.magnet">
                                <div class="bg-gray-700 rounded-lg p-4 hover:bg-gray-600 transition-colors duration-300">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="flex items-center space-x-2">
                                            <span class="text-purple-400 font-semibold" x-text="torrent.quality || 'N/A'"></span>
                                            <span class="text-gray-400">‚Ä¢</span>
                                            <span class="text-gray-300" x-text="torrent.type || 'N/A'"></span>
                                        </div>
                                        <div class="flex items-center space-x-1 text-green-400">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
                                            </svg>
                                            <span x-text="torrent.seeders || '0'"></span>
                                        </div>
                                    </div>
                                    <a :href="torrent.magnet" class="block w-full text-center bg-purple-600 text-white text-sm font-medium rounded-md py-2 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors">
                                        Download Torrent
                                    </a>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- right column (content details) -->
                <div class="space-y-6">
                    <!-- overview -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <div class="flex items-center justify-between section-header" @click="toggleSection('overview')">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <h3 class="text-xl font-semibold">Overview</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300" :class="sections.overview ? 'rotate-180' : ''" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                        <div class="section-content mt-4" :class="sections.overview ? 'expanded' : 'collapsed'">
                            <p class="text-gray-300" x-text="content?.overview"></p>
                        </div>
                    </div>

                    <!-- details -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <div class="flex items-center justify-between section-header" @click="toggleSection('details')">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                                <h3 class="text-xl font-semibold">Details</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300" :class="sections.details ? 'rotate-180' : ''" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                        <div class="section-content mt-4" :class="sections.details ? 'expanded' : 'collapsed'">
                            <div>
                                <!-- content warnings -->
                                <template x-if="content?.adult || content?.violence || content?.profanity || content?.substances || content?.suggestive || content?.flashing">
                                    <div class="mb-4">
                                        <h4 class="text-lg font-semibold text-purple-400 mb-3">Content Warnings</h4>
                                        <div class="space-y-2">
                                            <template x-if="content?.adult">
                                                <div class="flex items-center space-x-2 text-red-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                                    </svg>
                                                    <span>Adult Content (R/NC-17)</span>
                                                </div>
                                            </template>
                                            <template x-if="content?.violence">
                                                <div class="flex items-center space-x-2 text-orange-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                                    </svg>
                                                    <span>Violence/Gore</span>
                                                </div>
                                            </template>
                                            <template x-if="content?.profanity">
                                                <div class="flex items-center space-x-2 text-yellow-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                                    </svg>
                                                    <span>Strong Language</span>
                                                </div>
                                            </template>
                                            <template x-if="content?.substances">
                                                <div class="flex items-center space-x-2 text-blue-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                                    </svg>
                                                    <span>Drug/Alcohol Use</span>
                                                </div>
                                            </template>
                                            <template x-if="content?.suggestive">
                                                <div class="flex items-center space-x-2 text-pink-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                                    </svg>
                                                    <span>Sexual Content</span>
                                                </div>
                                            </template>
                                            <template x-if="content?.flashing">
                                                <div class="flex items-center space-x-2 text-purple-400">
                                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                                    </svg>
                                                    <span>Flashing Lights/Photosensitivity</span>
                                                </div>
                                            </template>
                                        </div>
                                    </div>
                                </template>

                                <!-- other details -->
                                <div class="space-y-2">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Status:</span>
                                        <span x-text="content?.status"></span>
                                    </p>
                                    <p class="text-gray-300">
                                        <span class="font-medium">Release Date:</span>
                                        <span x-text="content?.release_date || content?.first_air_date"></span>
                                    </p>
                                    <template x-if="isShow">
                                        <p class="text-gray-300">
                                            <span class="font-medium">Seasons:</span>
                                            <span x-text="content?.number_of_seasons"></span>
                                        </p>
                                    </template>
                                    <p class="text-gray-300">
                                        <span class="font-medium">Rating: ‚≠ê<span x-text="content?.vote_average?.toFixed(1) + '/10 (' + content?.vote_count + ' votes)'"></span></span>
                                    </p>
                                    <p class="text-gray-300">
                                        <span class="font-medium">Genres:</span>
                                        <span x-text="content?.genres?.map(g => g.name).join(', ')"></span>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- cast -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <div class="flex items-center justify-between section-header" @click="toggleSection('cast')">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                </svg>
                                <h3 class="text-xl font-semibold">Cast</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300" :class="sections.cast ? 'rotate-180' : ''" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                        <div class="section-content mt-4" :class="sections.cast ? 'expanded' : 'collapsed'">
                            <div class="relative overflow-visible px-6">
                                <button @click="castPage > 0 && castPage--" 
                                        class="absolute left-0 top-1/2 -translate-y-1/2 bg-gray-900 p-2 rounded-full hover:bg-gray-700 transition-all duration-300 z-20"
                                        :class="castPage === 0 ? 'opacity-50 cursor-not-allowed' : 'opacity-100'">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                                    </svg>
                                </button>
                                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4 relative overflow-hidden">
                                    <template x-for="actor in displayedCast" :key="actor.id">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-12 h-12 flex-shrink-0">
                                                <template x-if="actor.profile_path">
                                                    <img :src="'https://image.tmdb.org/t/p/w200' + actor.profile_path"
                                                         :alt="actor.name"
                                                         class="w-full h-full rounded-full object-cover">
                                                </template>
                                                <template x-if="!actor.profile_path">
                                                    <div class="w-full h-full rounded-full bg-gray-700 flex items-center justify-center text-xs text-gray-400">
                                                        X
                                                    </div>
                                                </template>
                                            </div>
                                            <div>
                                                <p class="font-medium text-sm" x-text="actor.name"></p>
                                                <p class="text-gray-400 text-xs" x-text="actor.character"></p>
                                            </div>
                                        </div>
                                    </template>
                                </div>
                                <button @click="castPage < maxCastPage && castPage++" 
                                        class="absolute right-0 top-1/2 -translate-y-1/2 bg-gray-900 p-2 rounded-full hover:bg-gray-700 transition-all duration-300 z-20"
                                        :class="castPage >= maxCastPage ? 'opacity-50 cursor-not-allowed' : 'opacity-100'">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                                    </svg>
                                </button>
                            </div>
                            <div class="flex justify-center mt-4 space-x-1">
                                <template x-for="page in maxCastPage + 1" :key="page">
                                    <button @click="castPage = page - 1"
                                            class="w-2 h-2 rounded-full transition-all duration-300"
                                            :class="castPage === page - 1 ? 'bg-purple-500' : 'bg-gray-600 hover:bg-gray-500'">
                                    </button>
                                </template>
                            </div>
                        </div>
                    </div>

                    <!-- production info -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <div class="flex items-center justify-between section-header" @click="toggleSection('production')">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                </svg>
                                <h3 class="text-xl font-semibold">Production Info</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300" :class="sections.production ? 'rotate-180' : ''" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                        <div class="section-content mt-4" :class="sections.production ? 'expanded' : 'collapsed'">
                            <div class="space-y-2">
                                <template x-if="content?.production_companies?.length > 0">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Studios:</span>
                                        <span x-text="content.production_companies.map(c => c.name).join(', ')"></span>
                                    </p>
                                </template>
                                <template x-if="content?.production_countries?.length > 0">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Countries:</span>
                                        <span x-text="content.production_countries.map(c => c.name).join(', ')"></span>
                                    </p>
                                </template>
                                <template x-if="content?.spoken_languages?.length > 0">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Languages:</span>
                                        <span x-text="content.spoken_languages.map(l => l.english_name).join(', ')"></span>
                                    </p>
                                </template>
                                <template x-if="!isShow && content?.runtime">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Runtime:</span>
                                        <span x-text="Math.floor(content.runtime / 60) + 'h ' + (content.runtime % 60) + 'm'"></span>
                                    </p>
                                </template>
                                <template x-if="content?.budget">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Budget:</span>
                                        <span x-text="'$' + content.budget.toLocaleString()"></span>
                                    </p>
                                </template>
                                <template x-if="content?.revenue">
                                    <p class="text-gray-300">
                                        <span class="font-medium">Revenue:</span>
                                        <span x-text="'$' + content.revenue.toLocaleString()"></span>
                                    </p>
                                </template>
                            </div>
                        </div>
                    </div>

                    <!-- trailers -->
                    <div class="bg-gray-800 rounded-lg p-6">
                        <div class="flex items-center justify-between section-header" @click="toggleSection('trailers')">
                            <div class="flex items-center space-x-3">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z" />
                                </svg>
                                <h3 class="text-xl font-semibold">Trailers & Videos</h3>
                            </div>
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transform transition-transform duration-300" :class="sections.trailers ? 'rotate-180' : ''" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </div>
                        <div class="section-content mt-4" :class="sections.trailers ? 'expanded' : 'collapsed'">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <template x-for="video in videos" :key="video.key">
                                    <div class="relative pb-[56.25%] bg-gray-700 rounded-lg overflow-hidden">
                                        <iframe 
                                            :src="'https://www.youtube.com/embed/' + video.key"
                                            class="absolute inset-0 w-full h-full"
                                            frameborder="0"
                                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                                            allowfullscreen>
                                        </iframe>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- similar content -->
            <div class="mt-8 md:mt-12">
                <h2 class="text-xl md:text-2xl font-bold mb-4 md:mb-6">Similar Content</h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-4" x-show="similarContent.length > 0">
                    <template x-for="item in similarContent" :key="item.id">
                        <div class="relative card-hover">
                            <a :href="'watch.html?id=' + item.id + '&type=' + contentType"
                               class="block rounded-lg overflow-hidden bg-gray-800 aspect-[2/3]">
                                <div class="relative h-full">
                                    <img
                                        :src="'https://image.tmdb.org/t/p/w500' + item.poster_path"
                                        :alt="item.title || item.name"
                                        class="w-full h-full object-cover transition-all flex items-center justify-center"
                                        @error="event => {
                                            event.target.src = '/logo.png';
                                            event.target.classList.remove('object-cover');
                                            event.target.classList.add('object-contain');
                                        }" />
                                    <div class="card-overlay absolute inset-0 flex flex-col justify-end p-2 sm:p-3 md:p-4">
                                        <h3 class="text-sm md:text-base font-semibold" x-text="item.title || item.name"></h3>
                                        <p class="text-gray-400 text-xs md:text-sm flex items-center mt-1">
                                            <span class="text-yellow-400 mr-1">‚≠ê</span>
                                            <span x-text="(item.vote_average || 'N/A') + '/10'"></span>
                                        </p>
                                        <p class="text-gray-300 text-xs mt-2 hidden sm:block" x-text="item.overview.substring(0, 100) + '...'"></p>
                                    </div>
                                </div>
                            </a>
                            <button @click.stop="toggleWatchLater(item)"
                                    class="absolute top-2 right-2 p-1.5 md:p-2 bg-gray-900 bg-opacity-75 rounded-full hover:bg-purple-600 transition-all duration-300"
                                    :class="isInWatchLater(item) ? 'text-purple-400' : 'text-white'">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 md:h-5 md:w-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/>
                                </svg>
                            </button>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <!-- streaming services -->
    <div class="container mx-auto px-6 py-12">
        <div class="text-center mb-8">
            <h2 class="text-2xl font-bold text-gray-300">Content Available From</h2>
            <p class="text-gray-400 mt-2">Nova aggregates content from various premium streaming platforms</p>
        </div>
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 items-center justify-items-center opacity-80">
            <a href="https://netflix.com" target="_blank" class="transform transition-transform hover:scale-105">
                <img src="https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg" 
                     alt="Netflix" 
                     class="h-8 w-auto grayscale hover:grayscale-0 hover:scale-110 hover:brightness-125 transition-all duration-300 transform hover:drop-shadow-[0_0_7px_rgba(229,9,20,0.7)]">
            </a>
            <a href="https://www.primevideo.com" target="_blank" class="transform transition-transform hover:scale-105">
                <img src="https://upload.wikimedia.org/wikipedia/commons/1/11/Amazon_Prime_Video_logo.svg" 
                     alt="Prime Video" 
                     class="h-8 w-auto grayscale hover:grayscale-0 hover:scale-110 hover:brightness-125 transition-all duration-300 transform hover:drop-shadow-[0_0_7px_rgba(0,168,225,0.7)]">
            </a>
            <a href="https://www.disneyplus.com" target="_blank" class="transform transition-transform hover:scale-105">
                <img src="https://upload.wikimedia.org/wikipedia/commons/3/3e/Disney%2B_logo.svg" 
                     alt="Disney+" 
                     class="h-8 w-auto grayscale hover:grayscale-0 hover:scale-110 hover:brightness-125 transition-all duration-300 transform hover:drop-shadow-[0_0_7px_rgba(113,168,255,0.7)]">
            </a>
            <a href="https://www.hulu.com" target="_blank" class="transform transition-transform hover:scale-105">
                <img src="https://upload.wikimedia.org/wikipedia/commons/f/f9/Hulu_logo_%282018%29.svg" 
                     alt="Hulu" 
                     class="h-7 w-auto grayscale hover:grayscale-0 hover:scale-110 hover:brightness-125 transition-all duration-300 transform hover:drop-shadow-[0_0_7px_rgba(28,231,131,0.7)]">
            </a>
            <a href="https://www.max.com" target="_blank" class="transform transition-transform hover:scale-105">
                <img src="https://upload.wikimedia.org/wikipedia/commons/1/17/HBO_Max_Logo.svg" 
                     alt="HBO Max" 
                     class="h-6 w-auto grayscale hover:grayscale-0 hover:scale-110 hover:brightness-125 transition-all duration-300 transform hover:drop-shadow-[0_0_7px_rgba(116,80,254,0.7)]">
            </a>
            <a href="https://tv.apple.com" target="_blank" class="transform transition-transform hover:scale-105">
                <img src="https://upload.wikimedia.org/wikipedia/commons/2/28/Apple_TV_Plus_Logo.svg" 
                     alt="Apple TV+" 
                     class="h-6 w-auto grayscale hover:grayscale-0 hover:scale-110 hover:brightness-125 transition-all duration-300 transform hover:drop-shadow-[0_0_7px_rgba(0,244,244,0.7)]">
            </a>
        </div>
    </div>

    <footer class="text-gray-400 py-6 mt-12">
        <div class="container mx-auto text-center">
            <p class="text-sm">
                Nova doesn't store files, but provides links to external services. Legal issues should be discussed with file providers and hosts. The files provided by video providers are not covered by Nova.
            </p>
            <p class="mt-2 text-xs">
                Made with ‚ù§ by Ambrosial. 19/02/25
            </p>
            <p class="mt-2 text-xs">
                <a href="mailto:contact.novastream@gmail.com" class="text-purple-400 hover:text-purple-300 transition-colors">contact.novastream@gmail.com</a>
            </p>
        </div>
    </footer>

    <!-- watch later modal -->
    <div x-show="showWatchLater" 
         class="fixed inset-0 z-50 overflow-auto bg-black bg-opacity-90 flex items-start justify-center"
         @click.away="showWatchLater = false"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0"
         x-transition:enter-end="opacity-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100"
         x-transition:leave-end="opacity-0">
        <div class="bg-gray-900 rounded-lg w-full max-w-4xl mt-20 modal-animation">
            <div class="p-6 border-b border-gray-800">
                <div class="flex items-center justify-between">
                    <h2 class="text-2xl font-bold">Watch Later</h2>
                    <div class="flex items-center space-x-4">
                        <button @click="showClearConfirm = true" 
                                x-show="watchLaterItems.length > 0"
                                class="text-gray-400 hover:text-red-500 flex items-center space-x-2 transition-colors duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                            <span>Clear All</span>
                        </button>
                        <button @click="showWatchLater = false" class="text-gray-500 hover:text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            <div class="p-6">
                <div x-show="!watchLaterItems.length" class="text-center text-gray-500 py-8">
                    No items in your watch later list
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
                    <template x-for="item in watchLaterItems" :key="item.id">
                        <div class="relative bg-gray-800 rounded-lg overflow-hidden">
                            <a :href="'watch.html?id=' + item.id + '&type=' + item.type"
                               class="block">
                                <img :src="'https://image.tmdb.org/t/p/w500' + item.poster_path" 
                                     :alt="item.title || item.name"
                                     class="w-full h-48 object-cover">
                                <div class="p-4">
                                    <h3 class="font-medium" x-text="item.title || item.name"></h3>
                                    <p class="text-gray-400 text-sm mt-1" x-text="'‚≠ê ' + (item.vote_average || 'N/A') + '/10'"></p>
                                </div>
                            </a>
                            <button @click="toggleWatchLater(item)"
                                    class="absolute top-2 right-2 p-2 bg-gray-900 bg-opacity-75 rounded-full hover:bg-purple-600 transition-all duration-300 text-purple-400">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"/>
                                </svg>
                            </button>
                        </div>
                    </template>
                </div>
            </div>
        </div>
    </div>

    <!-- clear confirmation modal -->
    <div x-show="showClearConfirm" 
         class="fixed inset-0 z-[60] overflow-auto bg-black bg-opacity-90 flex items-center justify-center"
         @click.away="showClearConfirm = false"
         x-transition:enter="transition ease-out duration-300"
         x-transition:enter-start="opacity-0 transform scale-95"
         x-transition:enter-end="opacity-100 transform scale-100"
         x-transition:leave="transition ease-in duration-200"
         x-transition:leave-start="opacity-100 transform scale-100"
         x-transition:leave-end="opacity-0 transform scale-95">
        <div class="bg-gray-900 rounded-lg w-full max-w-md p-6 modal-animation">
            <div class="text-center">
                <div class="w-16 h-16 rounded-full bg-red-500 bg-opacity-10 mx-auto flex items-center justify-center mb-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold mb-2">Clear Watch Later List?</h3>
                <p class="text-gray-400 mb-6">This action cannot be undone. Are you sure you want to remove all items from your watch later list?</p>
                <div class="flex space-x-3 justify-center">
                    <button @click="showClearConfirm = false" 
                            class="px-4 py-2 bg-gray-800 hover:bg-gray-700 rounded-lg transition-colors duration-300">
                        Cancel
                    </button>
                    <button @click="doClearWatchLater()" 
                            class="px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors duration-300">
                        Clear All
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- particles.js -->
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        particlesJS('particles-js', {
            particles: {
                number: {
                    value: 80,
                    density: {
                        enable: true,
                        value_area: 800
                    }
                },
                color: {
                    value: '#a855f7'
                },
                shape: {
                    type: 'circle'
                },
                opacity: {
                    value: 0.2,
                    random: true,
                    animation: {
                        enable: true,
                        speed: 1,
                        opacity_min: 0.1,
                        sync: false
                    }
                },
                size: {
                    value: 3,
                    random: true,
                    animation: {
                        enable: true,
                        speed: 2,
                        size_min: 0.1,
                        sync: false
                    }
                },
                line_linked: {
                    enable: true,
                    distance: 150,
                    color: '#a855f7',
                    opacity: 0.2,
                    width: 1
                },
                move: {
                    enable: true,
                    speed: 1,
                    direction: 'none',
                    random: true,
                    straight: false,
                    out_mode: 'out',
                    bounce: false,
                }
            },
            interactivity: {
                detect_on: 'window',
                events: {
                    onhover: {
                        enable: true,
                        mode: 'grab'
                    },
                    onclick: {
                        enable: true,
                        mode: 'push'
                    },
                    resize: true
                },
                modes: {
                    grab: {
                        distance: 140,
                        line_linked: {
                            opacity: 0.5
                        }
                    },
                    push: {
                        particles_nb: 4
                    }
                }
            },
            retina_detect: true
        });
    </script>

    <script>
        function app() {
            return {
                apiKey: '1070730380f5fee0d87cf0382670b255',
                content: null,
                contentId: null,
                contentType: null,
                isShow: false,
                selectedSeason: 1,
                selectedEpisode: 1,
                seasons: [],
                episodes: [],
                selectedSource: localStorage.getItem('defaultSource') || 'embedsu',
                availableSources: availableSources,
                currentVideoUrl: '',
                watchLaterItems: [],
                watchLaterCount: 0,
                showWatchLater: false,
                showClearConfirm: false,
                mobileMenu: false,
                viewMode: 'grid',
                seasonData: null,

                async init() {
                    const savedItems = localStorage.getItem('watchLater');
                    if (savedItems) {
                        this.watchLaterItems = JSON.parse(savedItems);
                        this.watchLaterCount = this.watchLaterItems.length;
                    }

                    const urlParams = new URLSearchParams(window.location.search);
                    this.contentId = urlParams.get('id');
                    this.contentType = urlParams.get('type');
                    this.isShow = this.contentType === 'tv';
                    this.selectedTorrentSeason = 1;

                    if (this.contentId && this.contentType) {
                        await this.fetchContent();
                        this.updateVideoUrl();
                        this.fetchTorrentInfo();
                    }
                },

                async fetchContent() {
                    const baseUrl = 'https://api.themoviedb.org/3';
                    const url = `${baseUrl}/${this.contentType}/${this.contentId}?api_key=${this.apiKey}&append_to_response=credits,similar,videos,reviews,release_dates,keywords`;
                    
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        this.content = data;
                        
                        const containsKeywords = (text, keywords) => {
                            if (!text) return false;
                            const lowercaseText = text.toLowerCase();
                            return keywords.some(keyword => lowercaseText.includes(keyword));
                        };

                        const overview = data.overview?.toLowerCase() || '';
                        const genres = data.genres?.map(g => g.name.toLowerCase()) || [];
                        const keywords = [...(data.keywords?.keywords || []), ...(data.keywords?.results || [])].map(k => k.name.toLowerCase());
                        
                        if (data.release_dates?.results) {
                            const usRating = data.release_dates.results.find(r => r.iso_3166_1 === 'US');
                            if (usRating) {
                                const certification = usRating.release_dates[0]?.certification;
                                this.content.adult = certification === 'R' || certification === 'NC-17';
                            }
                        }

                        const violenceKeywords = ['violence', 'violent', 'gore', 'bloody', 'blood', 'murder', 'kill', 'death', 'torture', 'fight', 'combat', 'war', 'brutal', 'massacre', 'slaughter', 'horror'];
                        this.content.violence = containsKeywords(overview, violenceKeywords) || 
                                              genres.some(g => ['horror', 'war', 'action'].includes(g)) ||
                                              keywords.some(k => violenceKeywords.some(vk => k.includes(vk)));

                        const languageKeywords = ['profanity', 'swearing', 'cursing', 'explicit language', 'strong language', 'vulgar'];
                        this.content.profanity = containsKeywords(overview, languageKeywords) ||
                                               keywords.some(k => languageKeywords.some(lk => k.includes(lk)));

                        const substanceKeywords = ['drug', 'alcohol', 'substance', 'addiction', 'smoking', 'drunk', 'intoxicated'];
                        this.content.substances = containsKeywords(overview, substanceKeywords) ||
                                                keywords.some(k => substanceKeywords.some(sk => k.includes(sk)));

                        const sexualKeywords = ['sexual', 'sex', 'nudity', 'erotic', 'suggestive', 'mature themes'];
                        this.content.suggestive = containsKeywords(overview, sexualKeywords) ||
                                                keywords.some(k => sexualKeywords.some(sk => k.includes(sk)));

                        const flashingKeywords = ['strobe', 'flashing', 'epilepsy', 'seizure', 'photosensitive'];
                        this.content.flashing = containsKeywords(overview, flashingKeywords) ||
                                              keywords.some(k => flashingKeywords.some(fk => k.includes(fk)));

                        if (!this.content.adult) {
                            this.content.adult = genres.includes('thriller') && 
                                               (this.content.violence || this.content.suggestive || this.content.substances);
                        }

                        if (this.isShow) {
                            this.seasons = Array.from({length: data.number_of_seasons}, (_, i) => i + 1);
                            await this.updateEpisodes();
                        }

                        if (data.videos?.results) {
                            this.videos = data.videos.results.filter(v => v.site === 'YouTube' && v.type === 'Trailer');
                        }

                        if (data.reviews?.results) {
                            this.reviews = data.reviews.results;
                        }

                        if (data.similar?.results) {
                            this.similarContent = data.similar.results.slice(0, 6);
                        }
                    } catch (error) {
                        console.error('Error fetching content:', error);
                    }
                },

                toggleWatchLater(item) {
                    const index = this.watchLaterItems.findIndex(i => i.id === item.id);
                    if (index === -1) {
                        this.watchLaterItems.push({
                            ...item,
                            type: this.contentType
                        });
                    } else {
                        this.watchLaterItems.splice(index, 1);
                    }
                    this.watchLaterCount = this.watchLaterItems.length;
                    localStorage.setItem('watchLater', JSON.stringify(this.watchLaterItems));
                },

                isInWatchLater(item) {
                    return this.watchLaterItems.some(i => i.id === item.id);
                },

                doClearWatchLater() {
                    this.watchLaterItems = [];
                    this.watchLaterCount = 0;
                    localStorage.setItem('watchLater', JSON.stringify([]));
                    this.showClearConfirm = false;
                },

                checkProviderStatus() {
                    if (this.currentVideoUrl === this.lastUrl) {
                        return;
                    }
                    this.lastUrl = this.currentVideoUrl;

                    if (this.providerTimeout) {
                        clearTimeout(this.providerTimeout);
                    }
                    if (this.messageTimeout) {
                        clearTimeout(this.messageTimeout);
                    }

                    this.providerDown = true;
                    this.showDownMessage = false;

                    this.providerTimeout = setTimeout(() => {
                        if (this.providerDown) {
                            console.log('Provider appears to be down - trying next source');
                            this.tryNextSource();
                            this.messageTimeout = setTimeout(() => {
                                this.showDownMessage = true;
                            }, 500);
                        }
                    }, 1500);
                },

                tryNextSource() {
                    const currentIndex = this.availableSources.findIndex(s => s.id === this.selectedSource);
                    if (currentIndex === -1) return;

                    const currentSource = this.availableSources[currentIndex];
                    const isFrench = currentSource.isFrench;
                    
                    let nextIndex = (currentIndex + 1) % this.availableSources.length;
                    while (nextIndex !== currentIndex) {
                        if (this.availableSources[nextIndex].isFrench === isFrench) {
                            this.selectedSource = this.availableSources[nextIndex].id;
                            this.updateVideoUrl();
                            return;
                        }
                        nextIndex = (nextIndex + 1) % this.availableSources.length;
                    }
                },

                handleProviderLoad() {
                    if (this.currentVideoUrl === this.lastUrl) {
                        if (this.providerTimeout) {
                            clearTimeout(this.providerTimeout);
                        }
                        if (this.messageTimeout) {
                            clearTimeout(this.messageTimeout);
                        }
                        this.providerDown = false;
                        this.showDownMessage = false;
                    }
                },

                updateVideoUrl() {
                    const source = this.availableSources.find(s => s.id === this.selectedSource);
                    if (!source) return '';

                    const params = this.isShow
                        ? { id: this.contentId, season: this.selectedSeason, episode: this.selectedEpisode }
                        : { id: this.contentId };

                    const newUrl = this.getSourceUrl(
                        this.selectedSource,
                        this.isShow ? 'tv' : 'movie',
                        params
                    );

                    if (newUrl !== this.currentVideoUrl) {
                        this.currentVideoUrl = newUrl;
                        this.checkProviderStatus();
                    }
                },

                getSourceUrl(sourceId, type, params) {
                    const source = this.availableSources.find(s => s.id === sourceId);
                    if (!source) return '';

                    let url = source.urls[type];
                    Object.entries(params).forEach(([key, value]) => {
                        url = url.replace(`{${key}}`, value);
                    });
                    return url;
                },

                async updateEpisodes() {
                    const url = `https://api.themoviedb.org/3/tv/${this.contentId}/season/${this.selectedSeason}?api_key=${this.apiKey}`;
                    try {
                        const response = await fetch(url);
                        const data = await response.json();
                        this.seasonData = data;
                        this.episodes = Array.from({length: data.episodes.length}, (_, i) => i + 1);
                        this.selectedEpisode = 1;
                        this.updateVideoUrl();
                    } catch (error) {
                        console.error('Error fetching episodes:', error);
                    }
                },

                loadEpisode() {
                    this.updateVideoUrl();
                },

                sections: {
                    overview: true,
                    details: true,
                    cast: true,
                    production: true,
                    trailers: true,
                    reviews: true,
                    viewingGuide: true
                },
                videos: [],
                reviews: [],
                castPage: 0,

                get maxCastPage() {
                    return Math.max(0, Math.ceil((this.content?.credits?.cast?.length || 0) / 6) - 1);
                },

                get displayedCast() {
                    const start = this.castPage * 6;
                    return this.content?.credits?.cast?.slice(start, start + 6) || [];
                },

                toggleSection(section) {
                    this.sections[section] = !this.sections[section];
                },

                torrentInfo: undefined,

                async fetchTorrentInfo() {
                    const contentTitle = this.content?.title || this.content?.name;
                    const releaseYear = (this.content?.release_date || this.content?.first_air_date || '').substring(0, 4);
                    if (!contentTitle) return;

                    this.torrentInfo = undefined;

                    try {
                        const corsProxy = 'https://api.allorigins.win/raw?url=';
                        
                        let searchQuery = contentTitle;
                        if (releaseYear) {
                            searchQuery += ` ${releaseYear}`;
                        }
                        if (this.isShow) {
                            searchQuery += ` S${String(this.selectedTorrentSeason).padStart(2, '0')}`;
                        }
                        
                        const targetUrl = `https://cloudtorrents.com/search?query=${encodeURIComponent(searchQuery)}&ordering=-se`;
                        console.log('Fetching torrents from:', targetUrl);
                        
                        const response = await fetch(corsProxy + encodeURIComponent(targetUrl));
                        if (!response.ok) {
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }
                        const html = await response.text();
                        
                        const parser = new DOMParser();
                        const doc = parser.parseFromString(html, 'text/html');
                        
                        const rows = doc.querySelectorAll('tbody tr');
                        console.log('Found rows:', rows.length);
                        
                        const qualityTypeMap = new Map();

                        for (const row of rows) {
                            const titleElement = row.querySelector('td:first-child a');
                            if (!titleElement) continue;

                            const title = titleElement.textContent.trim();
                            
                            if (!this.verifyTorrentTitle(title, contentTitle, releaseYear)) continue;

                            const magnetElement = row.querySelector('a[href^="magnet:"]');
                            if (!magnetElement) continue;

                            const magnetLink = magnetElement.href;
                            
                            let quality = 'N/A';
                            const qualityMatch = title.match(/\b(720p|1080p|2160p|4K)\b/i);
                            if (qualityMatch) {
                                quality = qualityMatch[1].toUpperCase();
                            }
                            
                            let type = 'N/A';
                            const typeMatch = title.match(/\b(BluRay|WEBDL|WEB-DL|WEBRip|HDRip|BRRip|DVDRip)\b/i);
                            if (typeMatch) {
                                type = typeMatch[1].replace('WEBDL', 'WEB-DL');
                            }

                            const sizeElement = row.querySelector('td:nth-child(4)');
                            const seedersElement = row.querySelector('td:nth-child(5)');
                            const seeders = parseInt(seedersElement?.textContent.trim() || '0', 10);

                            const torrent = {
                                quality,
                                type,
                                size: sizeElement ? sizeElement.textContent.trim() : 'N/A',
                                seeders: seeders,
                                magnet: magnetLink
                            };

                            const key = `${quality}-${type}`;
                            
                            if (!qualityTypeMap.has(key) || qualityTypeMap.get(key).seeders < seeders) {
                                qualityTypeMap.set(key, torrent);
                            }
                        }

                        const torrents = Array.from(qualityTypeMap.values());
                        torrents.sort((a, b) => {
                            const qualityOrder = { '4K': 4, '2160P': 3, '1080P': 2, '720P': 1, 'N/A': 0 };
                            const qualityDiff = (qualityOrder[b.quality] || 0) - (qualityOrder[a.quality] || 0);
                            if (qualityDiff !== 0) return qualityDiff;
                            return b.seeders - a.seeders;
                        });

                        this.torrentInfo = torrents.slice(0, 4);
                        if (this.torrentInfo.length === 0) {
                            this.torrentInfo = null;
                        }
                    } catch (error) {
                        console.error('Error fetching torrent info:', error);
                        this.torrentInfo = null;
                    }
                },

                verifyTorrentTitle(torrentTitle, contentTitle, releaseYear) {
                    const cleanTorrentTitle = torrentTitle.toLowerCase().replace(/[^a-z0-9]/g, '');
                    const cleanContentTitle = contentTitle.toLowerCase().replace(/[^a-z0-9]/g, '');
                    
                    if (!cleanTorrentTitle.includes(cleanContentTitle)) {
                        return false;
                    }
                    
                    if (releaseYear && !torrentTitle.includes(releaseYear)) {
                        return false;
                    }
                    
                    if (this.isShow) {
                        const seasonPattern = new RegExp(`S${String(this.selectedTorrentSeason).padStart(2, '0')}`, 'i');
                        if (!seasonPattern.test(torrentTitle)) {
                            return false;
                        }
                    }
                    
                    return true;
                }
            }
        }
    </script>
</body>
</html> 